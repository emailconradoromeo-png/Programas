"""
Conocimiento sobre la OHADA y su aplicaci√≥n en Guinea Ecuatorial.
Organizaci√≥n para la Armonizaci√≥n del Derecho Mercantil en √Åfrica.
"""

OHADA = {
    "informacion_general": {
        "titulo_es": "OHADA - Organizaci√≥n para la Armonizaci√≥n del Derecho Mercantil en √Åfrica",
        "titulo_fang": "OHADA - Organizaci√≥n ya Armonizaci√≥n ya Derecho Mercantil na √Åfrica",
        "descripcion_es": (
            "La OHADA (Organisation pour l'Harmonisation en Afrique du Droit des Affaires) "
            "es una organizaci√≥n internacional fundada el 17 de octubre de 1993 mediante "
            "el Tratado de Port-Louis (Isla Mauricio). Su objetivo es armonizar el derecho "
            "mercantil en √Åfrica para facilitar el comercio y la inversi√≥n. "
            "Guinea Ecuatorial se adhiri√≥ a la OHADA el 13 de diciembre de 1999, "
            "siendo el √∫nico pa√≠s hispan√≥fono miembro de la organizaci√≥n."
        ),
        "sede": "Yaund√©, Camer√∫n (Secretar√≠a Permanente)",
        "escuela": "ERSUMA - Porto-Novo, Ben√≠n (Escuela Regional Superior de Magistratura)",
        "corte": "CCJA - Abiy√°n, Costa de Marfil (Corte Com√∫n de Justicia y Arbitraje)",
        "miembros": "17 Estados miembros",
        "adhesion_gq": "13 de diciembre de 1999",
    },

    "estados_miembros": {
        "titulo_es": "Estados Miembros de la OHADA",
        "lista": [
            "Ben√≠n", "Burkina Faso", "Camer√∫n", "Chad", "Comoras",
            "Congo", "Costa de Marfil", "Gab√≥n", "Guinea",
            "Guinea-Bis√°u", "Guinea Ecuatorial", "Mal√≠", "N√≠ger",
            "Rep√∫blica Centroafricana", "Rep√∫blica Democr√°tica del Congo",
            "Senegal", "Togo",
        ],
    },

    "actas_uniformes": {
        "titulo_es": "Actas Uniformes de la OHADA",
        "titulo_fang": "Actas Uniformes ya OHADA",
        "descripcion_es": (
            "Las Actas Uniformes son leyes supranacionales directamente aplicables "
            "en todos los Estados miembros. Prevalecen sobre las leyes nacionales "
            "en materia de derecho mercantil."
        ),
        "actas": [
            {
                "nombre": "Acta Uniforme sobre Derecho Comercial General (AUDCG)",
                "descripcion": (
                    "Regula el estatuto del comerciante, el Registro de Comercio (RCCM), "
                    "la venta comercial, los intermediarios comerciales y el fondo de comercio."
                ),
                "fecha": "Adoptada en 1997, revisada en 2010",
            },
            {
                "nombre": "Acta Uniforme sobre Sociedades Comerciales y GIE (AUSCGIE)",
                "descripcion": (
                    "Regula la creaci√≥n, funcionamiento y disoluci√≥n de sociedades comerciales: "
                    "SNC, SCS, SARL, SA, SAS y Grupos de Inter√©s Econ√≥mico (GIE)."
                ),
                "fecha": "Adoptada en 1997, revisada en 2014",
            },
            {
                "nombre": "Acta Uniforme sobre Garant√≠as (AUS)",
                "descripcion": (
                    "Regula las garant√≠as personales (fianza, garant√≠a aut√≥noma, carta de intenci√≥n) "
                    "y las garant√≠as reales (hipoteca, prenda, privilegios)."
                ),
                "fecha": "Adoptada en 1997, revisada en 2010",
            },
            {
                "nombre": "Acta Uniforme sobre Procedimientos Simplificados de Cobro y V√≠as de Ejecuci√≥n (AUPSRVE)",
                "descripcion": (
                    "Regula el requerimiento de pago, los embargos conservatorios y ejecutivos, "
                    "y la distribuci√≥n del precio de venta."
                ),
                "fecha": "Adoptada en 1998",
            },
            {
                "nombre": "Acta Uniforme sobre Procedimientos Colectivos de Liquidaci√≥n (AUPCAP)",
                "descripcion": (
                    "Regula la prevenci√≥n de dificultades empresariales, los procedimientos "
                    "de conciliaci√≥n, reorganizaci√≥n judicial y liquidaci√≥n de bienes."
                ),
                "fecha": "Adoptada en 1998, revisada en 2015",
            },
            {
                "nombre": "Acta Uniforme sobre Arbitraje (AUA)",
                "descripcion": (
                    "Establece el marco legal para la resoluci√≥n de disputas comerciales "
                    "mediante arbitraje en el espacio OHADA."
                ),
                "fecha": "Adoptada en 1999, revisada en 2017",
            },
            {
                "nombre": "Acta Uniforme sobre Contabilidad y Informaci√≥n Financiera (AUDCIF)",
                "descripcion": (
                    "Establece las normas contables (SYSCOHADA) aplicables a las empresas: "
                    "plan de cuentas, estados financieros, consolidaci√≥n."
                ),
                "fecha": "Adoptada en 2000, revisada en 2017",
            },
            {
                "nombre": "Acta Uniforme sobre Transporte de Mercanc√≠as por Carretera (AUCTMR)",
                "descripcion": (
                    "Regula el contrato de transporte de mercanc√≠as por carretera entre "
                    "los Estados miembros de la OHADA."
                ),
                "fecha": "Adoptada en 2003",
            },
            {
                "nombre": "Acta Uniforme sobre Derecho de las Sociedades Cooperativas (AUDSC)",
                "descripcion": (
                    "Regula la creaci√≥n, funcionamiento y disoluci√≥n de las sociedades "
                    "cooperativas en el espacio OHADA."
                ),
                "fecha": "Adoptada en 2010",
            },
            {
                "nombre": "Acta Uniforme sobre Mediaci√≥n (AUM)",
                "descripcion": (
                    "Establece el marco legal para la mediaci√≥n como m√©todo alternativo "
                    "de resoluci√≥n de conflictos comerciales."
                ),
                "fecha": "Adoptada en 2017",
            },
        ],
    },

    "instituciones": {
        "titulo_es": "Instituciones de la OHADA",
        "instituciones": [
            {
                "nombre": "Consejo de Ministros",
                "funcion": "√ìrgano supremo de decisi√≥n. Adopta las Actas Uniformes por unanimidad.",
            },
            {
                "nombre": "Secretar√≠a Permanente (Yaund√©, Camer√∫n)",
                "funcion": "Coordina la preparaci√≥n y seguimiento de las Actas Uniformes.",
            },
            {
                "nombre": "CCJA - Corte Com√∫n de Justicia y Arbitraje (Abiy√°n, Costa de Marfil)",
                "funcion": (
                    "Tribunal supremo en materia de derecho OHADA. "
                    "Resuelve recursos de casaci√≥n y administra arbitrajes."
                ),
            },
            {
                "nombre": "ERSUMA - Escuela Regional Superior de Magistratura (Porto-Novo, Ben√≠n)",
                "funcion": "Forma a magistrados y juristas en derecho OHADA.",
            },
        ],
    },

    "importancia_gq": {
        "titulo_es": "Importancia de la OHADA para Guinea Ecuatorial",
        "titulo_fang": "Importancia ya OHADA ya Guinea Ecuatorial",
        "puntos_es": [
            "Guinea Ecuatorial es el √öNICO pa√≠s hispan√≥fono miembro de la OHADA",
            "Las Actas Uniformes se aplican directamente y prevalecen sobre la ley nacional",
            "Facilita la creaci√≥n de empresas con reglas claras y uniformes",
            "Protege las inversiones extranjeras con seguridad jur√≠dica",
            "Permite resolver disputas comerciales mediante arbitraje internacional (CCJA)",
            "Armoniza la contabilidad empresarial con el sistema SYSCOHADA",
            "Los empresarios ecuatoguineanos pueden operar en 17 pa√≠ses con las mismas reglas",
            "Moderniza el marco jur√≠dico empresarial del pa√≠s",
            "La adhesi√≥n fue el 13 de diciembre de 1999",
        ],
    },

    "crear_empresa": {
        "titulo_es": "Crear una Empresa seg√∫n la OHADA en Guinea Ecuatorial",
        "tipos_sociedad": [
            {
                "tipo": "SARL (Sociedad de Responsabilidad Limitada)",
                "capital_minimo": "1.000.000 FCFA",
                "socios": "1 a 100 socios",
                "descripcion": "La forma m√°s com√∫n para peque√±as y medianas empresas.",
            },
            {
                "tipo": "SA (Sociedad An√≥nima)",
                "capital_minimo": "10.000.000 FCFA",
                "socios": "M√≠nimo 1 accionista",
                "descripcion": "Para grandes empresas, permite cotizar en bolsa.",
            },
            {
                "tipo": "SAS (Sociedad por Acciones Simplificada)",
                "capital_minimo": "Libre (fijado por estatutos)",
                "socios": "1 o m√°s",
                "descripcion": "Forma flexible introducida en la reforma de 2014.",
            },
            {
                "tipo": "SNC (Sociedad en Nombre Colectivo)",
                "capital_minimo": "Libre",
                "socios": "2 o m√°s",
                "descripcion": "Los socios responden solidaria e ilimitadamente.",
            },
            {
                "tipo": "GIE (Grupo de Inter√©s Econ√≥mico)",
                "capital_minimo": "Libre",
                "socios": "2 o m√°s personas o empresas",
                "descripcion": "Para agrupar actividades econ√≥micas sin fines lucrativos propios.",
            },
        ],
    },
}


def buscar_ohada(texto):
    """Busca informaci√≥n de OHADA relevante seg√∫n el texto."""
    texto = texto.lower().strip()
    resultados = []

    keywords_map = {
        "informacion_general": [
            "ohada", "qu√© es ohada", "que es ohada", "armonizaci√≥n",
            "armonizacion", "derecho mercantil", "tratado",
        ],
        "estados_miembros": ["miembros", "estados", "pa√≠ses", "paises", "miembro"],
        "actas_uniformes": [
            "acta", "actas", "uniforme", "ley", "leyes", "audcg", "auscgie",
            "sarl", "comercial", "garant√≠a", "garantia", "arbitraje",
            "contabilidad", "transporte", "cooperativa", "mediaci√≥n", "mediacion",
        ],
        "instituciones": [
            "instituci√≥n", "institucion", "ccja", "ersuma", "secretar√≠a",
            "secretaria", "consejo", "corte", "tribunal",
        ],
        "importancia_gq": [
            "importancia", "guinea ecuatorial", "beneficio", "ventaja",
            "por qu√©", "por que", "para qu√©", "para que",
        ],
        "crear_empresa": [
            "empresa", "crear empresa", "sociedad", "sarl", "negocio",
            "capital", "emprender", "registrar", "comercio",
        ],
    }

    for seccion, keywords in keywords_map.items():
        if any(kw in texto for kw in keywords):
            resultados.append(seccion)

    return resultados


def formatear_ohada(secciones, idioma="es"):
    """Formatea las secciones de OHADA para respuesta."""
    texto = ""

    for seccion in secciones[:2]:  # M√°ximo 2 secciones
        datos = OHADA.get(seccion, {})

        if seccion == "informacion_general":
            titulo = datos.get(f"titulo_{idioma}", datos.get("titulo_es", ""))
            texto += f"*{titulo}*\n\n"
            texto += f"{datos['descripcion_es']}\n\n"
            texto += f"Sede: {datos['sede']}\n"
            texto += f"Miembros: {datos['miembros']}\n"
            texto += f"Adhesi√≥n de GQ: {datos['adhesion_gq']}\n\n"

        elif seccion == "estados_miembros":
            texto += f"*{datos['titulo_es']}:*\n\n"
            for i, pais in enumerate(datos["lista"], 1):
                marca = " ‚Üê üá¨üá∂" if pais == "Guinea Ecuatorial" else ""
                texto += f"{i}. {pais}{marca}\n"
            texto += "\n"

        elif seccion == "actas_uniformes":
            titulo = datos.get(f"titulo_{idioma}", datos.get("titulo_es", ""))
            texto += f"*{titulo}:*\n\n"
            texto += f"{datos['descripcion_es']}\n\n"
            for acta in datos["actas"]:
                texto += f"*{acta['nombre']}*\n"
                texto += f"  {acta['descripcion']}\n"
                texto += f"  ({acta['fecha']})\n\n"

        elif seccion == "instituciones":
            texto += f"*{datos['titulo_es']}:*\n\n"
            for inst in datos["instituciones"]:
                texto += f"*{inst['nombre']}*\n"
                texto += f"  {inst['funcion']}\n\n"

        elif seccion == "importancia_gq":
            titulo = datos.get(f"titulo_{idioma}", datos.get("titulo_es", ""))
            texto += f"*{titulo}:*\n\n"
            for punto in datos["puntos_es"]:
                texto += f"- {punto}\n"
            texto += "\n"

        elif seccion == "crear_empresa":
            texto += f"*{datos['titulo_es']}:*\n\n"
            for soc in datos["tipos_sociedad"]:
                texto += f"*{soc['tipo']}*\n"
                texto += f"  Capital m√≠nimo: {soc['capital_minimo']}\n"
                texto += f"  Socios: {soc['socios']}\n"
                texto += f"  {soc['descripcion']}\n\n"

    if not texto:
        texto = formatear_resumen_ohada(idioma)

    return texto.strip()


def formatear_resumen_ohada(idioma="es"):
    """Retorna un resumen general de OHADA."""
    if idioma == "fang":
        return (
            "*OHADA - Derecho Mercantil na √Åfrica*\n\n"
            "Guinea Ecuatorial ane miembro ya OHADA desde 1999.\n\n"
            "Fila uno ya temas yayie:\n"
            "- *ohada* - Informaci√≥n general\n"
            "- *actas uniformes* - Leyes mercantiles\n"
            "- *crear empresa* - Tipos de sociedad\n"
            "- *instituciones ohada* - √ìrganos de la OHADA\n"
            "- *miembros ohada* - Pa√≠ses miembros"
        )
    return (
        "*OHADA - Derecho Mercantil en √Åfrica*\n\n"
        "Guinea Ecuatorial es miembro de la OHADA desde 1999.\n\n"
        "Escribe uno de estos temas para m√°s informaci√≥n:\n"
        "- *ohada* - Informaci√≥n general\n"
        "- *actas uniformes* - Leyes mercantiles aplicables\n"
        "- *crear empresa* - Tipos de sociedad y requisitos\n"
        "- *instituciones ohada* - √ìrganos de la OHADA\n"
        "- *miembros ohada* - Los 17 pa√≠ses miembros"
    )
