"""
Conocimiento sobre la Constitución de Guinea Ecuatorial.
Ley Fundamental reformada en 2012.
"""

CONSTITUCION = {
    "informacion_general": {
        "titulo": "Constitución de la República de Guinea Ecuatorial",
        "titulo_fang": "Ley Fundamental ya República ya Guinea Ecuatorial",
        "fecha_original": "15 de agosto de 1968 (Independencia)",
        "ultima_reforma": "2012 (Referéndum del 13 de noviembre de 2011)",
        "descripcion_es": (
            "La Constitución de Guinea Ecuatorial es la ley suprema del país. "
            "Fue aprobada originalmente en 1968 con la independencia de España. "
            "Ha sido reformada en varias ocasiones, siendo la última reforma "
            "aprobada por referéndum en noviembre de 2011 y promulgada en 2012. "
            "Establece a Guinea Ecuatorial como un Estado soberano, independiente, "
            "republicano, unitario, social y democrático."
        ),
        "descripcion_fang": (
            "Constitución ya Guinea Ecuatorial ane ley e mam ya nnam. "
            "A biang na 1968 okiri a biki nnam España. "
            "A reformar mebere, ya último na 2011-2012."
        ),
    },

    "estructura": {
        "titulo_es": "Estructura de la Constitución",
        "titulo_fang": "Estructura ya Constitución",
        "contenido_es": [
            "Preámbulo - Principios fundamentales de la nación",
            "Título I - De la Nación, la Soberanía y el Territorio (Arts. 1-14)",
            "Título II - De los Derechos y Deberes Fundamentales (Arts. 15-28)",
            "Título III - Del Poder Ejecutivo (Arts. 29-50)",
            "Título IV - Del Poder Legislativo (Arts. 51-72)",
            "Título V - Del Poder Judicial (Arts. 73-87)",
            "Título VI - De la Organización Territorial del Estado (Arts. 88-99)",
            "Título VII - De la Reforma Constitucional (Arts. 100-104)",
            "Disposiciones Transitorias y Finales",
        ],
    },

    "derechos_fundamentales": {
        "titulo_es": "Derechos y Deberes Fundamentales",
        "titulo_fang": "Derechos ne Deberes Fundamentales",
        "derechos_es": [
            "Derecho a la vida y a la integridad física y moral (Art. 15)",
            "Igualdad ante la ley sin discriminación (Art. 15)",
            "Libertad de expresión y de opinión (Art. 17)",
            "Libertad de reunión y de asociación (Art. 18)",
            "Libertad de circulación y de residencia (Art. 19)",
            "Derecho a la educación (Art. 24)",
            "Derecho a la salud y al bienestar social (Art. 25)",
            "Derecho al trabajo y a una remuneración justa (Art. 26)",
            "Libertad religiosa y de culto (Art. 16)",
            "Inviolabilidad del domicilio y correspondencia (Art. 20)",
            "Derecho a la propiedad privada (Art. 27)",
            "Derecho a la tutela judicial efectiva (Art. 21)",
        ],
        "deberes_es": [
            "Respetar la Constitución y las leyes del Estado",
            "Defender la patria y su integridad territorial",
            "Contribuir a los gastos públicos mediante impuestos",
            "Respetar los derechos de los demás ciudadanos",
            "Cumplir el servicio militar según la ley",
        ],
    },

    "poder_ejecutivo": {
        "titulo_es": "El Poder Ejecutivo",
        "titulo_fang": "Poder Ejecutivo",
        "contenido_es": [
            "El Presidente de la República es el Jefe de Estado y de Gobierno (Art. 32)",
            "Elegido por sufragio universal directo por un mandato de 7 años (Art. 34)",
            "El Presidente puede ser reelegido (Art. 34)",
            "Nombra al Primer Ministro y a los miembros del Gobierno (Art. 38)",
            "Es el Comandante Supremo de las Fuerzas Armadas (Art. 41)",
            "Dirige la política interior y exterior del Estado (Art. 37)",
            "Puede disolver la Cámara de los Diputados (Art. 40)",
            "El Consejo de Ministros es el órgano colegiado del Gobierno (Art. 43)",
            "El Primer Ministro coordina la acción del Gobierno (Art. 44)",
            "Se crea la figura del Vicepresidente de la República (reforma 2012)",
        ],
    },

    "poder_legislativo": {
        "titulo_es": "El Poder Legislativo",
        "titulo_fang": "Poder Legislativo",
        "contenido_es": [
            "Parlamento bicameral compuesto por dos Cámaras (reforma 2012):",
            "  - Cámara de los Diputados (Cámara Baja)",
            "  - Senado (Cámara Alta, creada en la reforma de 2012)",
            "Los Diputados son elegidos por sufragio universal directo (Art. 52)",
            "El mandato legislativo es de 5 años (Art. 53)",
            "La Cámara aprueba las leyes y los presupuestos del Estado (Art. 56)",
            "El Senado participa en la función legislativa (Art. 62 bis)",
            "El Parlamento controla la acción del Gobierno (Art. 57)",
            "Los parlamentarios gozan de inmunidad parlamentaria (Art. 55)",
        ],
    },

    "poder_judicial": {
        "titulo_es": "El Poder Judicial",
        "titulo_fang": "Poder Judicial",
        "contenido_es": [
            "La justicia emana del pueblo y se administra en nombre del Jefe de Estado (Art. 73)",
            "Tribunal Supremo de Justicia - máximo órgano judicial (Art. 74)",
            "Tribunal Constitucional - controla la constitucionalidad (reforma 2012) (Art. 75 bis)",
            "Tribunal de Cuentas - fiscalización de cuentas públicas (Art. 76)",
            "Tribunales de Apelación y Juzgados de Primera Instancia (Art. 77)",
            "Tribunales Consuetudinarios - aplican el derecho tradicional (Art. 78)",
            "El Consejo del Poder Judicial vela por la independencia judicial (Art. 80)",
            "Los jueces son independientes y solo están sometidos a la ley (Art. 79)",
        ],
    },

    "organizacion_territorial": {
        "titulo_es": "Organización Territorial del Estado",
        "titulo_fang": "Organización ya nnam",
        "contenido_es": [
            "Guinea Ecuatorial se divide en Regiones y Distritos (Art. 88)",
            "Región Insular: Bioko Norte, Bioko Sur, Annobón",
            "Región Continental: Litoral, Centro-Sur, Kie-Ntem, Wele-Nzas",
            "Capital: Malabo (en la isla de Bioko)",
            "Cada Región está gobernada por un Delegado de Gobierno (Art. 91)",
            "Se reconoce la autonomía local de los municipios (Art. 93)",
            "Ciudad de Oyala (Djibloho) designada como futura capital (reforma 2012)",
        ],
    },

    "simbolos_nacionales": {
        "titulo_es": "Símbolos Nacionales",
        "titulo_fang": "Símbolos ya nnam",
        "contenido_es": [
            "Bandera: tres franjas horizontales (verde, blanco, rojo) con triángulo azul y escudo",
            "Escudo: árbol de ceiba (silk cotton tree) - símbolo nacional",
            "Lema: 'Unidad, Paz, Justicia'",
            "Himno Nacional: 'Caminemos pisando las sendas de nuestra inmensa felicidad'",
            "Idiomas oficiales: Español y Francés (Art. 4)",
            "Lenguas de cultura: Fang, Bubi, y demás lenguas autóctonas (Art. 4)",
            "Moneda: Franco CFA de África Central (XAF)",
        ],
    },
}


def buscar_constitucion(texto):
    """Busca información constitucional relevante según el texto."""
    texto = texto.lower().strip()
    resultados = []

    keywords_map = {
        "informacion_general": ["constitución", "constitucion", "ley fundamental", "ley suprema", "reforma"],
        "estructura": ["estructura", "títulos", "titulos", "artículos", "articulos", "organización"],
        "derechos_fundamentales": [
            "derecho", "derechos", "deber", "deberes", "libertad", "igualdad",
            "educación", "educacion", "salud", "trabajo", "expresión", "expresion",
            "religión", "religion", "propiedad",
        ],
        "poder_ejecutivo": [
            "presidente", "ejecutivo", "gobierno", "ministro", "primer ministro",
            "vicepresidente", "jefe de estado", "fuerzas armadas",
        ],
        "poder_legislativo": [
            "legislativo", "parlamento", "cámara", "camara", "diputado", "senado",
            "senador", "ley", "leyes", "presupuesto",
        ],
        "poder_judicial": [
            "judicial", "justicia", "tribunal", "juez", "jueces", "supremo",
            "constitucional", "cuentas", "consuetudinario",
        ],
        "organizacion_territorial": [
            "territorio", "territorial", "región", "region", "distrito", "capital",
            "malabo", "oyala", "insular", "continental", "municipio",
        ],
        "simbolos_nacionales": [
            "símbolo", "simbolo", "bandera", "escudo", "himno", "lema",
            "idioma oficial", "moneda", "franco", "ceiba",
        ],
    }

    for seccion, keywords in keywords_map.items():
        if any(kw in texto for kw in keywords):
            resultados.append(seccion)

    return resultados


def formatear_constitucion(secciones, idioma="es"):
    """Formatea las secciones de la constitución para respuesta."""
    texto = ""

    for seccion in secciones[:3]:  # Máximo 3 secciones
        datos = CONSTITUCION.get(seccion, {})

        if seccion == "informacion_general":
            titulo = datos.get("titulo_fang" if idioma == "fang" else "titulo", "")
            desc = datos.get(f"descripcion_{idioma}", datos.get("descripcion_es", ""))
            texto += f"*{titulo}*\n\n{desc}\n\n"
            texto += f"Fecha original: {datos['fecha_original']}\n"
            texto += f"Última reforma: {datos['ultima_reforma']}\n\n"

        elif seccion == "estructura":
            titulo = datos.get(f"titulo_{idioma}", datos.get("titulo_es", ""))
            texto += f"*{titulo}:*\n\n"
            for item in datos.get("contenido_es", []):
                texto += f"- {item}\n"
            texto += "\n"

        elif seccion == "derechos_fundamentales":
            titulo = datos.get(f"titulo_{idioma}", datos.get("titulo_es", ""))
            texto += f"*{titulo}:*\n\n"
            texto += "*Derechos:*\n"
            for d in datos.get("derechos_es", []):
                texto += f"- {d}\n"
            texto += "\n*Deberes:*\n"
            for d in datos.get("deberes_es", []):
                texto += f"- {d}\n"
            texto += "\n"

        elif seccion == "simbolos_nacionales":
            titulo = datos.get(f"titulo_{idioma}", datos.get("titulo_es", ""))
            texto += f"*{titulo}:*\n\n"
            for item in datos.get("contenido_es", []):
                texto += f"- {item}\n"
            texto += "\n"

        else:
            titulo = datos.get(f"titulo_{idioma}", datos.get("titulo_es", ""))
            texto += f"*{titulo}:*\n\n"
            for item in datos.get("contenido_es", []):
                texto += f"- {item}\n"
            texto += "\n"

    if not texto:
        texto = formatear_resumen_constitucion(idioma)

    return texto.strip()


def formatear_resumen_constitucion(idioma="es"):
    """Retorna un resumen general de la constitución."""
    if idioma == "fang":
        return (
            "*Constitución ya Guinea Ecuatorial*\n\n"
            "Ley Fundamental ya nnam, reformada na 2012.\n\n"
            "Fila uno ya temas yayie:\n"
            "- *derechos* - Derechos ne deberes\n"
            "- *presidente* - Poder Ejecutivo\n"
            "- *parlamento* - Poder Legislativo\n"
            "- *justicia* - Poder Judicial\n"
            "- *territorio* - Organización territorial\n"
            "- *bandera* - Símbolos nacionales"
        )
    return (
        "*Constitución de Guinea Ecuatorial*\n\n"
        "Ley Fundamental del Estado, última reforma en 2012.\n\n"
        "Escribe uno de estos temas para más información:\n"
        "- *derechos* - Derechos y deberes fundamentales\n"
        "- *presidente* - Poder Ejecutivo\n"
        "- *parlamento* - Poder Legislativo\n"
        "- *justicia* - Poder Judicial\n"
        "- *territorio* - Organización territorial\n"
        "- *bandera* - Símbolos nacionales"
    )
